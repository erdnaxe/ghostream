<?xml version="1.0" encoding="UTF-8" ?>

<Server version="7">
    <Name>OvenMediaEngine</Name>
    <Type>origin</Type>
    <IP>*</IP>

    <Bind>
        <Providers>
            <RTMP>
                <Port>1915</Port>
            </RTMP>
        </Providers>
        <Publishers>
            <WebRTC>
                <Signalling>
                    <Port>3333</Port>
                </Signalling>
                <IceCandidates>
                    <IceCandidate>*:10006-10010/udp</IceCandidate>
                </IceCandidates>
            </WebRTC>
            <HLS>
                <Port>80</Port>
            </HLS>
        </Publishers>
    </Bind>

    <VirtualHosts>
        <VirtualHost>
            <Name>default</Name>
            <Domain>
                <Names>
                    <Name>*</Name>
                </Names>
            </Domain>
            <Applications>
                <Application>
                    <Name>app</Name>
                    <Type>live</Type>
                    <Encodes>
                        <Encode>
                            <Name>opus_only</Name>
                            <Audio>
                                <Codec>opus</Codec>
                                <Bitrate>128000</Bitrate>
                                <Samplerate>48000</Samplerate>
                                <Channel>2</Channel>
                            </Audio>
                            <Video>
                                <Bypass>true</Bypass>
                            </Video>
                        </Encode>
                        <Encode>
                            <Name>BYPASS</Name>
                            <Video>
                                <Bypass>true</Bypass>
                            </Video>
                            <Audio>
                                <Bypass>true</Bypass>
                            </Audio>
                        </Encode>
                    </Encodes>
                    <Streams>
                        <Stream>
                            <Name>${OriginStreamName}</Name>
                            <Profiles>
                                <Profile>opus_only</Profile>
                            </Profiles>
                        </Stream>
                        <Stream>
                            <Name>${OriginStreamName}_bypass</Name>
                            <Profiles>
                                <Profile>BYPASS</Profile>
                            </Profiles>
                        </Stream>
                    </Streams>
                    <Providers>
                        <RTMP>
                            <BlockDuplicateStreamName>true</BlockDuplicateStreamName>
                        </RTMP>
                    </Providers>
                    <Publishers>
                        <ThreadCount>2</ThreadCount>
                        <WebRTC>
                            <Timeout>30000</Timeout>
                        </WebRTC>
                        <HLS>
                            <SegmentDuration>5</SegmentDuration>
                            <SegmentCount>2</SegmentCount>
                            <CrossDomain>
                                <Url>*</Url>
                            </CrossDomain>
                        </HLS>
                    </Publishers>
                </Application>
            </Applications>
        </VirtualHost>
    </VirtualHosts>
</Server>